<%# locals: (title:, categories:) %>

<div class="rounded-xl bg-container-inset space-y-1 p-1">
  <div class="flex items-center gap-1.5 px-4 py-2 text-xs font-medium text-secondary uppercase">
    <p><%= title %></p>
    <span class="text-subdued">&middot;</span>
    <p><%= categories.count %></p>
  </div>

  <div class="shadow-border-xs rounded-lg bg-container">
    <div class="overflow-hidden rounded-lg">
      <% Category::Group.for(categories).each_with_index do |group, idx| %>
        <!-- Parent category -->
        <%= render "categories/category_row", category: group.category %>

        <!-- Subcategories (initially visible, will be controlled by expand/collapse) -->
        <div class="subcategories-container" data-parent-id="<%= group.category.id %>">
          <% group.subcategories.each do |subcategory| %>
            <%= render "categories/category_row", category: subcategory %>
          <% end %>
        </div>

        <% unless idx == Category::Group.for(categories).count - 1 %>
          <%= render "shared/ruler" %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
